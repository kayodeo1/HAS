<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:o="http://omnifaces.org/ui"
	xmlns:of="http://omnifaces.org/functions">

<h:head>
	<f:metadata>
		<f:viewAction action="#{transactionBean.listTransaction()}" />
	</f:metadata>
</h:head>

<h:body>
	<ui:composition template="/online/templates/master.xhtml">
		<ui:define name="pageTitle">
            Update Profile
        </ui:define>

		<ui:define name="body_">
			<p:growl sticky="true" globalOnly="true"></p:growl>
			<h:form>

				<p:dataTable id="transactionList" var="entry"
					value="#{transactionBean.lazyModel}" paginator="true" rows="5"
					paginatorPosition="bottom"
					currentPageReportTemplate="Showing {startRecord}-{endRecord} out of {totalRecords}"
					paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
					rowsPerPageTemplate="5,10,15" selectionMode="single"
					selection="#{transactionBean.entry}" lazy="true"
					rowKey="#{entry.id}">
					<f:facet name="header">
						<hr />
						<p:spacer></p:spacer>
						<b></b>
						<strong>Transaction</strong> Entries Details </f:facet>


					<p:column headerText="name" style="text-align:center;" filterBy="#{entry.name}"
								filterMatchMode="contains">
						<h:outputText value="NA" rendered="#{entry.name==null} " />
						<h:outputText value="#{entry.name}"  />
					</p:column>
					<p:column headerText="email" style="text-align:center;" filterBy="#{entry.email}"
								filterMatchMode="contains">
						<h:outputText value="NA" rendered="#{entry.email==null} " />
						<h:outputText value="#{entry.email}" />
					</p:column>

					<p:column headerText="amount" style="text-align:center;">
						<h:outputText value="NA" rendered="#{entry.amount==null} " />
						<h:outputText value="#{entry.amount}">
							<f:convertNumber pattern="¤#,##0.00" currencySymbol="&#8358;" />
						</h:outputText>
					</p:column>
					<p:column headerText="Status" style="text-align:center;">
						<h:outputText value="PENDING" rendered="#{entry.status==null} " />
						<h:outputText value="#{entry.status}" />
					</p:column>
					<p:column headerText="paymentReference" style="text-align:center;" filterBy="#{entry.paymentReference}"
								filterMatchMode="contains">
						<h:outputText value="NA"
							rendered="#{entry.paymentReference==null} " />
						<h:outputText value="#{entry.paymentReference}" />
					</p:column>
					<p:column headerText="">
						<p:menuButton value="Action">
							<p:menuitem value="Refresh Status"
								icon="ui-icon-arrowrefresh-1-w" style="font-size:1em!important;"
								process="@this" rendered="#{! (entry.status=='SUCCESSFUL')}" update="@form"
								actionListener="#{transactionBean.refreshTransaction(entry.paymentReference)}"
								immediate="true" oncomplete="PF('transactionDialog').show()">
							</p:menuitem>
							<p:menuitem value="View" icon="ui-icon-arrowrefresh-1-w"
								style="font-size:1em!important;" process="@this" update="@form"
								actionListener="#{transactionBean.displayTransactionDialog(entry)}"
								immediate="true" oncomplete="PF('transactionDialog').show()">
							</p:menuitem>
						</p:menuButton>
					</p:column>
				</p:dataTable>

<div style="overflow:scroll">
	<p:dialog id="transactionDialog" widgetVar="transactionDialog" fitViewport="true"
				header="Transaction Details" modal="true" resizable="false"
				width="450" height="auto">

				<div style="font-family: Arial, sans-serif; color: #333;">

					<!-- Customer Name -->
					<div
						style="margin-bottom: 16px; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px;">
						<div
							style="font-size: 11px; font-weight: bold; color: #666; text-transform: uppercase; margin-bottom: 4px;">
							Customer Name</div>
						<div style="font-size: 16px; color: #333;">
							#{transactionBean.entry.name != null ? transactionBean.entry.name
							: 'N/A'}</div>
					</div>

					<!-- Email -->
					<div
						style="margin-bottom: 16px; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px;">
						<div
							style="font-size: 11px; font-weight: bold; color: #666; text-transform: uppercase; margin-bottom: 4px;">
							Email Address</div>
						<div style="font-size: 16px; color: #333;">
							#{transactionBean.entry.email != null ?
							transactionBean.entry.email : 'N/A'}</div>
					</div>

					<!-- Amount -->
					<div
						style="margin-bottom: 16px; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px;">
						<div
							style="font-size: 11px; font-weight: bold; color: #666; text-transform: uppercase; margin-bottom: 4px;">
							Amount</div>
						<div style="font-size: 24px; font-weight: bold; color: #2399e5;">
							<h:outputText value="#{transactionBean.entry.amount}">
								<f:convertNumber pattern="¤#,##0.00" currencySymbol="₦" />
							</h:outputText>
						</div>
					</div>

					<!-- Status -->
					<div
						style="margin-bottom: 16px; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px;">
						<div
							style="font-size: 11px; font-weight: bold; color: #666; text-transform: uppercase; margin-bottom: 4px;">
							Status</div>
						<div style="font-size: 16px;">
							<span
								style="padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; text-transform: uppercase;
                           background: #{transactionBean.entry.status == 'SUCCESSFUL' ? '#e8f5e8' : 
                                      (transactionBean.entry.status == 'FAILED' ? '#ffebee' : '#fff3e0')};
                           color: #{transactionBean.entry.status == 'SUCCESSFUL' ? '#2e7d32' : 
                                  (transactionBean.entry.status == 'FAILED' ? '#d32f2f' : '#f57c00')};">
								#{transactionBean.entry.status != null ?
								transactionBean.entry.status : 'PENDING'} </span>
						</div>
					</div>

					<!-- Payment Reference -->
					<div
						style="margin-bottom: 16px; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px;">
						<div
							style="font-size: 11px; font-weight: bold; color: #666; text-transform: uppercase; margin-bottom: 4px;">
							Payment Reference</div>
						<div
							style="font-size: 16px; font-family: monospace; background: #f8f9fa; padding: 4px 8px; border-radius: 4px;">
							#{transactionBean.entry.paymentReference != null ?
							transactionBean.entry.paymentReference : 'N/A'}</div>
					</div>

					<!-- Transaction Reference -->
					<div
						style="margin-bottom: 16px; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px;">
						<div
							style="font-size: 11px; font-weight: bold; color: #666; text-transform: uppercase; margin-bottom: 4px;">
							Transaction Reference</div>
						<div
							style="font-size: 16px; font-family: monospace; background: #f8f9fa; padding: 4px 8px; border-radius: 4px;">
							#{transactionBean.entry.transactionReference != null ?
							transactionBean.entry.transactionReference : 'N/A'}</div>
					</div>

					<!-- Payment Method -->
					<div
						style="margin-bottom: 16px; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px;">
						<div
							style="font-size: 11px; font-weight: bold; color: #666; text-transform: uppercase; margin-bottom: 4px;">
							Payment Method</div>
						<div style="font-size: 16px; color: #333;">
							#{transactionBean.entry.paymentMethod != null ?
							transactionBean.entry.paymentMethod : 'N/A'}</div>
					</div>

					<!-- Created Date -->
					<div style="margin-bottom: 16px;">
						<div
							style="font-size: 11px; font-weight: bold; color: #666; text-transform: uppercase; margin-bottom: 4px;">
							Created Date</div>
						<div style="font-size: 16px; color: #333;">
							<h:outputText value="#{transactionBean.entry.createdDate}">
								<f:convertDateTime pattern="MMM dd, yyyy hh:mm a" />
							</h:outputText>
						</div>
					</div>

				</div>

				<f:facet name="footer">
					<div style="text-align: right;">
						<p:commandButton value="Close"
							style="margin-right: 8px; background: #f5f5f5; color: #666; border: 1px solid #ddd; padding: 8px 16px; border-radius: 4px;"
							onclick="PF('transactionDialog').hide()" type="button" />

						<p:commandButton value="Refresh Status"
							style="background: #2399e5; color: white; border: none; padding: 8px 16px; border-radius: 4px;"
							actionListener="#{transactionBean.refreshTransaction(transactionBean.entry.paymentReference)}"
							process="@this" update="transactionList"
							oncomplete="PF('transactionDialog').hide()"
							rendered="#{transactionBean.entry.status != 'SUCCESSFUL'}" />
					</div>
				</f:facet>

			</p:dialog>
			 </div>
			</h:form>
		


		</ui:define>
	</ui:composition>
</h:body>
</html>